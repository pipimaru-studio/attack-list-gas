# 📋 attack-list-gas

Googleスプレッドシート上で、営業リスト（アタックリスト）の作成・整形・重複チェックなどを自動化する Google Apps Script（GAS）です。

---

## 🚀 使い方

- **企業名の整形**  
  「アタックリスト」シートの **B列** に会社名を入力すると、自動的に整形されます。

- **電話番号の整形**  
  「アタックリスト」シートの **F列** に電話番号を入力すると、自動的に整形されます。

- **メールアドレスの整形**  
  「アタックリスト」シートの **G列** にメールアドレスを入力すると、自動的に整形されます。

- **自動入力日**  
  「アタックリスト」シートの **K列（入力日欄）** が空欄の場合、自動で今日の日付が入力されます。

- **重複チェック**  
  「重複企業チェック」シートに企業名を入力すると、既存リストと照合して重複が検出されます。

---

## 🛠 主な機能

- 編集時トリガー（`onEdit`）による自動処理
- 企業名や電話番号、メールアドレスの整形
- 入力日の自動入力（空欄の場合）
- 既存企業との重複チェック

---

## 📁 ファイル構成

| ファイル名             | 内容                                               |
|------------------------|----------------------------------------------------|
| `onEdit.gs`            | 編集トリガーのエントリーポイント。各処理に振り分け |
| `format.gs`            | 入力値の整形処理（企業名・電話番号・メールアドレスなど）           |
| `duplicateCheck.gs`    | 重複企業チェックのロジック、およびリセット処理      |
| `convert.gs`           | 企業名や電話番号、メールアドレスの整形に使うユーティリティ関数（正規表現処理など）                          |
| `customMenu.gs`        | スプレッドシートにカスタムメニューを作成する関数    |

### 💡 構成のポイント
- 処理の役割ごとにファイルを分けて、読みやすく保守しやすい構造にしています。
- onEdit.gs はトリガーの「入口」であり、他のファイルの関数を呼び出します。
- format.gs と duplicateCheck.gs は それぞれ独立した処理単位 として機能します。
- convert.gs には 再利用性の高い共通関数 をまとめています。
- customMenu.gs は UI 側（スプレッドシートのメニュー）を拡張するファイルです。


---

## 💡 こんな工夫をしました！

### 自動入力ルールの適用

Webサイトから企業情報をコピー＆ペーストした際に、手動で入力ルールを守る必要がないよう工夫しました。以下のような変換が自動で行われます：

- **改行や空白の自動削除**  
  コピー時に余計な改行や前後の空白を気にせず貼り付け可能です。

- **会社名の変換**  
  カタカナは全角に、英数字は半角に統一。さらに「（株）」なども「株式会社」に変換します。

- **電話番号の整形**  
  数字のみを抽出し、ハイフンを自動で挿入します。（例：0123456789 → 012-3456-7890）

- **メールアドレスの整形**  
  メールアドレスのみを抽出し、英数字・記号を半角に統一します。（例：email:info@abc.com → info@abc.com）

この工夫により、企業HPからコピーした内容をそのまま貼り付けるだけで、ルールに沿った整形が自動で行われます！

---

### 重複チェック機能

同じ企業に何度も営業をかけてしまうリスクを防ぐため、**「重複企業チェック」** 機能を追加しました。

- 手動で重複チェックを行うと、同じ企業が何度もリストに出てくることがあり、特にデータベース系のサイトでは効率が悪くなります。
- 自動化されたチェックにより、検索前に重複確認ができるようになり、ミスも減って作業効率が大幅に向上しました！


---

## 📝 補足

- 参考スプレッドシート： https://docs.google.com/spreadsheets/d/1joufzsAf7cNObpx7MspTcK9PTUR1bGSKqlpQCaW-FvA/edit?usp=sharing
- 対象シート：
  - `アタックリスト`
  - `重複企業チェック`
- カスタムメニューから「重複企業チェックのリセット」と「アタックリストの会社名の一括整形」も可能です。

---

## 👤 作者

**pipimaru-studio**  
> 現在、GitHubの使い方やポートフォリオ作成も学習中 🐣

---

## 🚧 今後の予定（ToDo）

- [ ] UIの強化（サイドバーで操作できるようにする？）
- [ ] コードのリファクタリング
- [ ] READMEの英語対応　など

---

✨ これから徐々に整えていく予定です。応援よろしくお願いします！
