# 📋 attack-list-gas

Googleスプレッドシート上で、営業リスト（アタックリスト）の作成・整形・重複チェックなどを自動化する Google Apps Script（GAS）です。

---

## 🚀 使い方

- **企業名の整形**  
  「アタックリスト」シートの **B列** に会社名を入力すると、自動的に整形されます。

- **電話番号の整形**  
  「アタックリスト」シートの **F列** に電話番号を入力すると、自動的に整形されます。

- **重複チェック**  
  「重複企業チェック」シートに企業名を入力すると、既存リストと照合して重複が検出されます。

- **自動入力日**  
  「アタックリスト」シートの **K列（入力日欄）** が空欄の場合、自動で今日の日付が入力されます。

---

## 🛠 主な機能

- 編集時トリガー（`onEdit`）による自動処理
- 企業名や電話番号の整形
- 既存企業との重複チェック
- 入力日の自動入力（空欄の場合）

---

## 📁 ファイル構成

| ファイル名             | 内容                                               |
|------------------------|----------------------------------------------------|
| `onEdit.gs`            | 編集トリガーのエントリーポイント。各処理に振り分け |
| `format.gs`            | 入力値の整形処理（企業名・電話番号など）           |
| `duplicateCheck.gs`    | 重複企業チェックのロジック、およびリセット処理      |
| `convert.gs`           | 企業名や電話番号の整形に使うユーティリティ関数（正規表現処理など）                          |
| `customMenu.gs`        | スプレッドシートにカスタムメニューを作成する関数    |


attack-list-gas/
├── onEdit.gs          // 編集トリガーの入口。アタックリスト整形処理か重複チェック処理を振り分け
├── format.gs          // 会社名・電話番号の整形処理
├── duplicateCheck.gs  // 重複チェック処理（既存企業との照合）
├── convert.gs         // 整形処理で使う共通関数（正規化など）
└── customMenu.gs      // スプレッドシートに独自メニューを追加

💡 構成のポイント
- 処理の役割ごとにファイルを分けて、読みやすく保守しやすい構造にしています。
- onEdit.gs はトリガーの「入口」であり、他のファイルの関数を呼び出します。
- format.gs と duplicateCheck.gs は それぞれ独立した処理単位 として機能します。
- convert.gs には 再利用性の高い共通関数 をまとめています。
- customMenu.gs は UI 側（スプレッドシートのメニュー）を拡張するファイルです。

---

💡 こんな工夫をしました
自動入力ルールの適用:
Webサイトから企業情報をコピー＆ペーストした際に、手動で入力ルールを守る必要がないように工夫しました。これにより、以下のような変換が自動で行われます：

改行や空白の自動削除: コピー時に余計な改行や空白を気にせず入力でき、後で手動で修正する必要がありません。

会社名の変換: カタカナを全角に変換、英数字を半角に統一。また、「（株）」などを自動で「株式会社」に変換。

電話番号の整形: 数字だけ抽出し、ハイフンを自動挿入します。

この工夫により、企業HPからコピーした内容をそのまま貼り付けても、ルールに沿った整形が自動で行われ、前後の空白などを気にせず簡単に入力できます！

重複チェック機能:
同じ企業に何度も営業をかけてしまうリスクを防ぐため、**「重複企業チェック」**機能を追加しました。これにより、企業HPの情報をコピーする前に重複チェックが行われ、重複した企業が誤って追加されないようにします。

手動で重複チェックを行う場合、同じ企業が複数回登場することがあり、特にサイトによっては何度も重複を処理しなければならないため、効率が悪くなります。自動化された重複チェックにより、ミスが減り、作業効率が大幅に向上しました！

---

## 📝 補足

- 対象シート：
  - `アタックリスト`
  - `重複企業チェック`
- カスタムメニューから「重複企業チェックのリセット」、「重複企業チェックを実行」と「アタックリストの会社名の一括整形」も可能です。

---

## 👤 作者

**pipimaru-studio**  
> 現在、GitHubの使い方やポートフォリオ作成も学習中 🐣

---

## 🚧 今後の予定（ToDo）

- [ ] UIの強化（サイドバーで操作できるようにする？）
- [ ] コードのリファクタリング
- [ ] READMEの英語対応　など

---

✨ これから徐々に整えていく予定です。応援よろしくお願いします！
